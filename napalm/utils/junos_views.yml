---

####
#### Interface table
####

junos_iface_table:
  rpc: get-interface-information
  args:
    extensive: True
  args_key: interface_name
  item: physical-interface
  view: junos_iface_view

junos_iface_view:
  fields:
    is_up: { oper-status: True=up }
    is_enabled: { admin-status: True=up }
    description: { description: unicode }
    last_flapped: { interface-flapped/@seconds: int }
    #mode: logical-interface/address-family/address-family-name
    speed: speed
    mac_address: current-physical-address

####
#### BGP tables
####

junos_route_instance_table:
  rpc: get-instance-information
  item: instance-core
  key: instance-name
  view: junos_route_instance_view

junos_route_instance_view:
  fields:
    name: instance-name

junos_bgp_uptime_table:
  rpc: get-bgp-summary-information
  args:
    instance: ''
  item: bgp-peer
  key: peer-address
  view: junos_bgp_uptime_view

junos_bgp_uptime_view:
  fields:
    uptime: { elapsed-time/@seconds: int }
  tables: bgp-rib/name

junos_bgp_table:
  rpc: get-bgp-neighbor-information
  item: bgp-peer

  key: peer-address
  view: junos_bgp_view

junos_bgp_view:
  fields:
    remote_as: { peer-as: int }
    description: description
    is_up: { peer-state: True=Established }
    is_enabled: { peer-state: False=True }
    received_prefixes: { bgp-rib/received-prefix-count: int }
    accepted_prefixes: { bgp-rib/accepted-prefix-count: int }
    sent_prefixes: { bgp-rib/advertised-prefix-count: int }
    tables: bgp-rib/name
    local_as: { local-as: int }
    peer_as: { peer-as: int }
    local_id: local-id
    remote_id: { peer-id: unicode }

####
#### LLDP table
####

junos_lldp_table:
  rpc: get-lldp-neighbors-information
  item: lldp-neighbor-information
  key: lldp-local-port-id | lldp-local-interface
  view: junos_lldp_view

junos_lldp_view:
  fields:
    hostname: lldp-remote-system-name
    port: lldp-remote-port-description | lldp-remote-port-id

####
#### Interface counters
####

junos_iface_counter_table:
  rpc: get-interface-information
  args:
    extensive: True
    interface_name: '[vmfgx][mle]*'
  args_key: interface_name
  item: physical-interface
  view: junos_iface_counter_view


junos_iface_counter_view:
  groups:
    ts: traffic-statistics
    rxerrs: input-error-list
    txerrs: output-error-list
    ethernet_traffic_types: ethernet-mac-statistics


  # fields that are part of groups are called
  # "fields_<group-name>"
  fields_ethernet_traffic_types:
    rx_broadcast_packets: { input-broadcasts: int }
    tx_broadcast_packets: { output-broadcasts: int }
    rx_unicast_packets: { input-unicasts: int }
    tx_unicast_packets: { output-unicasts: int }
    rx_multicast_packets: { input-multicasts: int }
    tx_multicast_packets: { output-multicasts: int }

  fields_ts:
    rx_octets: { input-bytes: int }
    tx_octets: { output-bytes: int }

  fields_rxerrs:
    rx_errors: { input-errors: int }
    rx_discards: { input-discards: int }

  fields_txerrs:
    tx_errors: { output-errors: int }
    tx_discards: { output-drops: int }

junos_enviroment_table:
  rpc: get-environment-information
  args:
  item: environment-item
  key: name
  view: junos_enviroment_view

junos_enviroment_view:
  fields:
    class: class
    status: status
    temperature: { temperature/@celsius: int }

junos_routing_engine_table:
  rpc: get-route-engine-information
  args:
  item: route-engine
  key: slot
  view: junos_routing_engine_view

junos_routing_engine_view:
  fields:
    cpu-idle: { cpu-idle: int }
    memory-dram-size: { memory-dram-size: int }
    memory-buffer-utilization : { memory-buffer-utilization: int }

junos_temperature_thresholds:
  rpc: get-temperature-threshold-information
  args:
  item: temperature-threshold
  key: name
  view: junos_temperature_thresholds_view

junos_temperature_thresholds_view:
  fields:
    name: name
    yellow-alarm: { yellow-alarm: int }
    red-alarm: { red-alarm: int }
    tx_discards: { output-drops: int }

###
### ARP Table
###

junos_arp_table:
  rpc: get-arp-table-information
  item: arp-table-entry
  key: interface-name
  view: junos_arp_view

junos_arp_view:
  fields:
    mac_address: mac-address
    ip_address: ip-address
    hostname: hostname
    flags: arp-table-entry-flags

###
### LLDP Neighbors
###

junos_lldp_neighbors_detail_table:
  rpc: get-lldp-neighbors-information
  item: lldp-neighbor-information
  key: lldp-local-port-id
  view: junos_lldp_neighbors_detail_view

junos_lldp_neighbors_detail_view:
  fields:
    parent_interface: lldp-local-parent-interface-name
    remote_port: lldp-remote-port-id
    remote_system_chassis_id: lldp-remote-chassis-id
    remote_system_name: lldp-remote-system-name

###
### Route Information
###

junos_route_table:
  rpc: get-route-information
  args_key:
    destination
  item: route-table/rt
  key: rt-destination
  view: junos_route_table_view

junos_route_table_view:
  fields:
    protocol: rt-entry/protocol-name
    active_route: {rt-entry/active-tag: True=*}
    age: {rt-entry/age/@seconds: int}
    as_path: rt-entry/as-path
    next_hop: rt-entry/nh/to
    outgoing_interface: rt-entry/nh/via
    local_preference: {rt-entry/local-preference: int}
    preference: {rt-entry/preference: int}

###
### MAC Address table
###

junos_mac_address_table:
  rpc: get-bridge-mac-table
  item: l2ald-mac-entry
  key: l2-mac-logical-interface
  view: junos_mac_address_view

junos_mac_address_view:
  fields:
    vlan: {l2-bridge-vlan: int}
    logical_interface: l2-mac-logical-interface
    bridge_domain: l2-mac-bridging-domain
    logical_system: logical-system
    base_logical_interface: l2-mac-base-logical-interface
    mac_addresses: l2-mac-address
    routing_instance: l2-mac-routing-instance

####
#### BGP Neighbors and Routing Tables Stats
####

junos_bgp_tables_summary_table:
  rpc: get-bgp-summary-information
  args:
    instance: ''
    group: ''
  item: bgp-rib
  key: name
  view: junos_bgp_tables_summary_view

junos_bgp_tables_summary_view:
  fields:
    routing_table: name
    total_prefix_count: {total-prefix-count: int}
    received_prefix_count: {received-prefix-countL: int}
    active_prefix_count: {active-prefix-count: int}
    suppressed_prefix_count: {suppressed-prefix-count: int}
    history_prefix_count: {history-prefix-count: int}
    damped_prefix_count: {damped-prefix-count: int}
    total_external_prefix_count: {total-external-prefix-count: int}
    active_external_prefix_count: {active-external-prefix-count: int}
    accepted_external_prefix_count: {accepted-external-prefix-count: int}
    suppressed_external_prefix_count: {suppressed-external-prefix-count: int}
    total_internal_prefix_count: {total-internal-prefix-count: int}
    active_internal_prefix_count: {active-internal-prefix-count: int}
    accepted_internal_prefix_count: {accepted-internal-prefix-count: int}
    suppressed_internal_prefix_count: {suppressed-internal-prefix-count: int}
    pending_prefix_count: {pending-prefix-count: int}
    bgp_rib_state: bgp-rib-state

junos_bgp_neighbors_table:
  rpc: get-bgp-neighbor-information
  args_key: neighbor_address
  item: bgp-peer
  key: peer-as
  view: junos_bgp_neighbors_view

junos_bgp_neighbors_view:
  fields:
    peer_address: peer-address
    peer_as: {peer-as: int}
    peer_type: peer-type
    local_as: {local-as: int}
    up: {peer-state: True=Established}
    input_messages: {input-messages: int}
    output_messages: {output-messages: int}
    route_queue_count: {route-queue-count: int}
    flap_count: {flap-count: int}
    last_flap_event: last-flap-event
    local_interface_name: local-interface-name
    local_interface_index: local-interface-index
    last_received: {last-received: int}
    last_sent: {last-sent: int}
    last_checked: {last-checked: int}
    elapsed_time: {elapsed-time/@seconds: int}
    rib_name: bgp-rib/name
    export_policy: bgp-option-information/export-policy
    import_policy: bgp-option-information/import-policy
    active_prefix_count: {bgp-rib/active-prefix-count: int}
    received_prefix_count: {bgp-rib/received-prefix-count: int}
    accepted_prefix_count: {bgp-rib/accepted-prefix-count: int}
    suppressed_prefix_count: {bgp-rib/suppressed-prefix-count: int}

###
### Interfaces IPs
###

junos_ip_interfaces_table:
  rpc: get-interface-information
  item: physical-interface
  view: junos_ip_interfaces_view

junos_ip_interfaces_view:
  fields:
    ip: logical-interface/address-family/interface-address/ifa-local
